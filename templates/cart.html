<!-- templates/cart.html -->
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Shopping Cart - Medi kart</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.0/font/bootstrap-icons.css">
    <style>
        :root { --primary-teal: #00a699; --bg-soft: #f8fafc; }
        body { background-color: var(--bg-soft); font-family: 'Poppins', sans-serif; }
        .cart-card { border: none; border-radius: 20px; box-shadow: 0 10px 30px rgba(0,0,0,0.05); background: white; }
        .qty-btn { width: 32px; height: 32px; border-radius: 8px; border: 1px solid #ddd; background: white; display: flex; align-items: center; justify-content: center; text-decoration: none; color: #333; }
        .qty-btn:hover { background: var(--primary-teal); color: white; border-color: var(--primary-teal); }
        .summary-box { background: #002b5c; color: white; border-radius: 25px; padding: 30px; position: sticky; top: 100px; }
        .product-img { width: 80px; height: 80px; object-fit: contain; background: #f9f9f9; border-radius: 15px; }
    </style>
</head>
<body>

<div class="container py-5">
    <div class="row">
        <!-- Progress Bar -->
        <div class="col-12 mb-5">
            <div class="d-flex justify-content-between position-relative">
                <div class="text-center z-1"><div class="badge bg-primary rounded-pill mb-2">1</div><br><small class="fw-bold">Cart</small></div>
                <div class="text-center z-1"><div class="badge bg-secondary rounded-pill mb-2">2</div><br><small>Checkout</small></div>
                <div class="text-center z-1"><div class="badge bg-secondary rounded-pill mb-2">3</div><br><small>Payment</small></div>
                <div class="progress position-absolute top-25 start-0 w-100" style="height: 2px; margin-top: 15px; z-index: -1;">
                    <div class="progress-bar w-0"></div>
                </div>
            </div>
        </div>

        <!-- Cart Items -->
        <div class="col-lg-8">
            <h4 class="fw-bold mb-4">Shopping Cart ({{ items|length }} Items)</h4>
            
            {% if items %}
                {% for item in items %}
                <div class="cart-card p-3 mb-3">
                    <div class="row align-items-center">
                        <div class="col-md-2 col-4">
                            <img src="{{ item.info.image_url }}" class="product-img">
                        </div>
                        <div class="col-md-4 col-8">
                            <h6 class="fw-bold mb-1">{{ item.info.name }}</h6>
                            <small class="text-muted">{{ item.info.category.name }}</small>
                        </div>
                        <div class="col-md-3 col-6 text-center">
                            <div class="d-flex align-items-center justify-content-center gap-3">
                                <a href="/update_cart/{{ item.info.id }}/sub" class="qty-btn">-</a>
                                <span class="fw-bold">{{ item.qty }}</span>
                                <a href="/update_cart/{{ item.info.id }}/add" class="qty-btn">+</a>
                            </div>
                        </div>
                        <div class="col-md-2 col-4 text-end">
                            <h6 class="fw-bold text-primary">₹{{ item.total }}</h6>
                        </div>
                        <div class="col-md-1 col-2 text-end">
                            <a href="/update_cart/{{ item.info.id }}/remove" class="text-danger"><i class="bi bi-trash3"></i></a>
                        </div>
                    </div>
                </div>
                {% endfor %}
                <a href="/" class="btn btn-link text-decoration-none text-muted mt-3">← Continue Shopping</a>
            {% else %}
                <div class="text-center py-5 cart-card">
                    <i class="bi bi-cart-x display-1 text-muted"></i>
                    <h5 class="mt-3">Your cart is empty!</h5>
                    <a href="/" class="btn btn-primary rounded-pill px-4 mt-2">Shop Now</a>
                </div>
            {% endif %}
        </div>

        <!-- Order Summary -->
        <div class="col-lg-4">
            <div class="summary-box shadow-lg">
                <h5 class="fw-bold mb-4">Order Summary</h5>
                <div class="d-flex justify-content-between mb-2">
                    <span class="opacity-75">Subtotal</span>
                    <span>₹{{ subtotal }}</span>
                </div>
                <div class="d-flex justify-content-between mb-2">
                    <span class="opacity-75">Delivery Fee</span>
                    <span class="text-success">{{ 'FREE' if delivery == 0 else '₹' + delivery|string }}</span>
                </div>
                {% if delivery > 0 %}
                <small class="text-warning d-block mb-3">Add ₹{{ 500 - subtotal }} more for FREE delivery!</small>
                {% endif %}
                <hr>
                <div class="d-flex justify-content-between mb-4">
                    <h5 class="fw-bold">Total</h5>
                    <h5 class="fw-bold">₹{{ total }}</h5>
                </div>
                <a href="/checkout" class="btn btn-warning w-100 rounded-pill py-3 fw-bold text-dark {{ 'disabled' if not items }}">
                    PROCEED TO CHECKOUT
                </a>
                <div class="text-center mt-4">
                    <img src="https://upload.wikimedia.org/wikipedia/commons/b/b5/PayPal.svg" height="20" class="me-2 opacity-50">
                    <img src="https://upload.wikimedia.org/wikipedia/commons/5/5e/Visa_Inc._logo.svg" height="15" class="opacity-50">
                </div>
            </div>
        </div>
    </div>
</div>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>